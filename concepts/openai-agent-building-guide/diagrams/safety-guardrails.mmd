---
title: Agent Safety Guardrails System
description: Comprehensive 3-tier safety validation and risk management
---
flowchart TB
    %% User Input Phase
    UserInput([üë§ User Request]) --> InputAnalysis[üîç Input Analysis]
    
    %% Tier 1: Input Validation
    subgraph Tier1 [üõ°Ô∏è TIER 1: INPUT VALIDATION]
        direction TB
        InputAnalysis --> RelevanceCheck{üìã Relevance Check}
        InputAnalysis --> SafetyFilter{üîí Safety Filter}
        InputAnalysis --> PIIDetection{üÜî PII Detection}
        
        RelevanceCheck -->|‚úÖ Relevant| SafetyFilter
        RelevanceCheck -->|‚ùå Irrelevant| IrrelevantBlock[üö´ Request Blocked: Irrelevant]
        
        SafetyFilter -->|‚úÖ Safe Content| PIIDetection
        SafetyFilter -->|‚ùå Unsafe Content| UnsafeBlock[üö´ Request Blocked: Unsafe]
        
        PIIDetection -->|‚úÖ No PII Issues| InputApproved[‚úÖ Input Approved]
        PIIDetection -->|‚ö†Ô∏è PII Detected| PIIHandler{üîÑ PII Handler}
        
        PIIHandler -->|Sanitized| InputApproved
        PIIHandler -->|Cannot Sanitize| PIIBlock[üö´ Request Blocked: PII]
    end
    
    %% Agent Processing
    InputApproved --> AgentCore[ü§ñ Agent Core Processing]
    
    %% Tier 2: Tool Safety
    subgraph Tier2 [üõ†Ô∏è TIER 2: TOOL SAFETY]
        direction TB
        AgentCore --> ToolSelection[üîß Tool Selection]
        ToolSelection --> RiskAssessment{‚öñÔ∏è Risk Assessment}
        
        RiskAssessment -->|üü¢ Low Risk| LowRiskTools[‚úÖ Auto-Execute Safe Tools]
        RiskAssessment -->|üü° Medium Risk| MediumRiskReview{üë• Human Review}
        RiskAssessment -->|üî¥ High Risk| HighRiskBlock[üö´ Tool Blocked]
        
        LowRiskTools --> ToolExecution[‚ö° Tool Execution]
        MediumRiskReview -->|‚úÖ Approved| ToolExecution
        MediumRiskReview -->|‚ùå Denied| ToolDenied[üö´ Tool Access Denied]
        
        %% Tool Risk Categories
        subgraph RiskCategories [Risk Categories]
            direction TB
            LowRisk[üü¢ Low Risk<br/>‚Ä¢ Read operations<br/>‚Ä¢ Data retrieval<br/>‚Ä¢ Calculations]
            MediumRisk[üü° Medium Risk<br/>‚Ä¢ API calls<br/>‚Ä¢ Data modifications<br/>‚Ä¢ External integrations]
            HighRisk[üî¥ High Risk<br/>‚Ä¢ System commands<br/>‚Ä¢ Data deletion<br/>‚Ä¢ Financial transactions]
        end
    end
    
    %% Tool Results Processing
    ToolExecution --> ResultProcessing[üìä Process Tool Results]
    
    %% Tier 3: Output Validation
    subgraph Tier3 [üì§ TIER 3: OUTPUT VALIDATION]
        direction TB
        ResultProcessing --> OutputAnalysis[üîç Output Analysis]
        
        OutputAnalysis --> BrandAlignment{üéØ Brand Alignment}
        OutputAnalysis --> ContentSafety{üîí Content Safety}
        OutputAnalysis --> QualityCheck{‚úÖ Quality Check}
        
        BrandAlignment -->|‚úÖ On Brand| ContentSafety
        BrandAlignment -->|‚ùå Off Brand| BrandBlock[üö´ Output Blocked: Brand]
        
        ContentSafety -->|‚úÖ Safe Content| QualityCheck
        ContentSafety -->|‚ùå Unsafe Content| ContentBlock[üö´ Output Blocked: Safety]
        
        QualityCheck -->|‚úÖ High Quality| OutputApproved[‚úÖ Output Approved]
        QualityCheck -->|‚ùå Low Quality| QualityBlock[üö´ Output Blocked: Quality]
    end
    
    %% Final Response
    OutputApproved --> FinalResponse[üì¨ Deliver Response to User]
    
    %% Human Oversight Layer
    subgraph Oversight [üë• HUMAN OVERSIGHT]
        direction TB
        Monitor[üìä Continuous Monitoring]
        Escalation[üö® Escalation Triggers]
        Intervention[üõ†Ô∏è Manual Intervention]
        
        Monitor --> Escalation
        Escalation --> Intervention
    end
    
    %% Oversight Connections
    Oversight -.-> Tier1
    Oversight -.-> Tier2
    Oversight -.-> Tier3
    
    %% Audit Trail
    subgraph AuditTrail [üìã AUDIT TRAIL]
        direction TB
        LogInput[üìù Log Input Validation]
        LogTools[üìù Log Tool Usage]
        LogOutput[üìù Log Output Validation]
        LogBlocks[üìù Log Blocked Actions]
    end
    
    %% Logging Connections
    Tier1 -.-> LogInput
    Tier2 -.-> LogTools
    Tier3 -.-> LogOutput
    IrrelevantBlock -.-> LogBlocks
    UnsafeBlock -.-> LogBlocks
    PIIBlock -.-> LogBlocks
    HighRiskBlock -.-> LogBlocks
    ToolDenied -.-> LogBlocks
    BrandBlock -.-> LogBlocks
    ContentBlock -.-> LogBlocks
    QualityBlock -.-> LogBlocks
    
    %% Emergency Override
    EmergencyOverride[üÜò Emergency Override] -.-> AgentCore
    EmergencyOverride -.-> ToolExecution
    EmergencyOverride -.-> OutputApproved
    
    %% Styling
    classDef inputClass fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef safetyClass fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef warningClass fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef dangerClass fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef processClass fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef oversightClass fill:#f5f5f5,stroke:#616161,stroke-width:2px
    
    class UserInput,InputAnalysis,FinalResponse inputClass
    class InputApproved,LowRiskTools,ToolExecution,OutputApproved safetyClass
    class PIIHandler,MediumRiskReview,RiskAssessment warningClass
    class IrrelevantBlock,UnsafeBlock,PIIBlock,HighRiskBlock,ToolDenied,BrandBlock,ContentBlock,QualityBlock dangerClass
    class AgentCore,ResultProcessing,OutputAnalysis processClass
    class Oversight,Monitor,Escalation,Intervention,AuditTrail,LogInput,LogTools,LogOutput,LogBlocks,EmergencyOverride oversightClass
